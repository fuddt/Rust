---

marp: true

paginate: true

math: true

---

# <center>構造体について


---

# 構造体の使い所
関連する情報を１つにまとめたいときに使います。
例えば、競馬のデータを表す構造体を定義する場合、

```rust
struct Horse {
    name: String,
    age: u32,
    color: String, // 毛の色
    father: String, // 父馬
    mother: String, // 母馬
}
```

という風に、馬の名前、年齢、毛の色、父馬、母馬などの情報を１つの構造体にまとめることでデータが扱いやすくなります。

---
例) 対象馬の情報を表示する関数を定義する場合

```rust
fn show_horse_info(horse: &Horse) {
    println!("Name: {}", horse.name);
    println!("Age: {}", horse.age);
    println!("Father: {}", horse.father);
    println!("Mother: {}", horse.mother);
}
```

```rust
fn main() {
    let horse = Horse {
        name: String::from("メイショウタバル"),
        age: 4,
        father: String::from("ゴールドシップ"),
        mother: String::from("メイショウツバクロ"),
    };

    show_horse_info(&horse);
}
```

---

構造体がもしもなかったら？
データを個別の変数として管理する必要があり、例えば以下のように書かなければなりません。

```rust
fn show_horse_info(name: &str, age: u32, father: &str, mother: &str) {
    println!("Name: {}", name);
    println!("Age: {}", age);
    println!("Father: {}", father);
    println!("Mother: {}", mother);
}
``` 
引数の多い関数を定義しなければいけないし、渡すときも大変・・・

---

```rust
fn main() {
    let name = "メイショウタバル";
    let age = 4;
    let father = "ゴールドシップ";
    let mother = "メイショウツバクロ";

    show_horse_info(name, age, father, mother);
}
```
どっかで、入れる順番を間違えてしまって、年齢で名前が表示されてしまうこともあるかもしれないので、構造体を定義した方がのちのちメリットが大きいです。

---

# 構造体更新記法

例えば騎手の情報を管理する構造体を定義したとします。

```rust
struct Jockey {
    name: String,
    age: u32,
    stable: String, // 所属厩舎
}
```

栗東という厩舎に所属する騎手の情報を列挙して定義したとします。

---
```rust
let jockey1 = Jockey {
    name: String::from("武豊"),
    age: 51,
    stable: String::from("栗東"),
};
let jockey2 = Jockey {
    name: String::from("福永祐一"),
    age: 45,
    stable: String::from("栗東"),
};
...あと何人かずっと栗東
```
stableの情報が同じなので、更新記法を使うことで、以下のように書くことができます。

---
```rust
let jockey1 = Jockey {
    name: String::from("武豊"),
    age: 51,
    stable: String::from("栗東"),
};
let jockey2 = Jockey {
    name: String::from("福永祐一"),
    age: 45,
    ..jockey1 // jockey1のstableをコピー
};
```
同じところは`..`を使うことで、同じフィールドの値をコピーすることができます。

---

# タプル構造体
構造体を定義したいけどフィールド名をつけるほどではない場合もあるかもしれない。画像系の処理などで、座標を表すためにタプル構造体を使うことがあります。

```rust
struct Point(i32, i32); // x座標とy座標を表す
```
タプル構造体は、フィールド名を持たない構造体で、タプルのように値を格納します。

```rust
let p = Point(10, 20);
println!("x: {}, y: {}", p.0, p.1); // x: 10, y: 20
```
わざわざフィールド名をつけるほどではない場合に便利です。

---

# 最初はとりあえず#[derive(Debug)]をつけておく
構造体を定義したら、まずは`#[derive(Debug)]`をつけておくと便利です。

```rust
#[derive(Debug)]
struct Horse {
    name: String,
    age: u32,
    color: String, // 毛の色
    father: String, // 父馬
    mother: String, // 母馬
}
```
これをつけることで、構造体の内容を`println!("{:?}", horse);`のようにデバッグ出力できるようになります。これにより、構造体の内容を簡単に確認できるので、デバッグや開発時に非常に便利。

---

```rust
fn main() {
    let horse = Horse {
        name: String::from("メイショウタバル"),
        age: 4,
        color: String::from("鹿毛"),
        father: String::from("ゴールドシップ"),
        mother: String::from("メイショウツバクロ"),
    };

    println!("{:?}", horse); 
}

出力結果
Horse { name: "メイショウタバル", age: 4, color: "鹿毛", father: "ゴールドシップ", mother: "メイショウツバクロ" }
```

とりあえずつけておこう。あって損はない。